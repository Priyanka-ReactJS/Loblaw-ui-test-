{"ast":null,"code":"var _jsxFileName = \"D:\\\\React_Projects\\\\loblaw-ui-test\\\\test\\\\src\\\\container\\\\dashboard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\"; //Note: Include bootstrap for responsive layout\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getCampaignDetails } from \"../store/actions/campaign\";\nimport { useHistory } from \"react-router-dom\";\nimport Cardwrap from '../component/cardwrap';\nimport Chart from \"../component/Chart\";\nimport '../index.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar dataImp = [0];\nvar dataClicks = [0];\nvar dataUsers = [0];\nvar dataCtr = [0];\nvar numInc = 0; //Note:Local storage variables\n\nconst locId = localStorage.getItem('id');\nconst locName = localStorage.getItem('name');\nconst template = {\n  userConfig: {\n    tooltip: {\n      pointFormat: \"<b>{point.y}</b>\"\n    },\n    plotOptions: {\n      pie: {\n        showInLegend: true,\n        innerSize: \"60%\",\n        dataLabels: {\n          enabled: true,\n\n          formatter() {\n            return this.point.name + ' : ' + Math.round(this.point.y * 100);\n          },\n\n          format: '{point.name} : ' + Math.round(this.point.y * 100),\n          distance: 5,\n          color: \"black\",\n          style: {\n            fontweight: \"bold\",\n            fontsize: 50\n          }\n        }\n      }\n    }\n  }\n};\n\nconst Dashboard = props => {\n  _s();\n\n  const campaignId = props.location.campaigns === undefined ? locId : props.location.campaigns.id;\n  const campaignName = props.location.campaigns === undefined ? locName : props.location.campaigns.name;\n  let api_url = \"http://localhost:4000/campaigns\"; //Note: Using redux-store for state management\n  // const campaign = props.location.campaigns;\n  // const dispatch = useDispatch();\n  // const [campaignDetails, setCampaign] = useState();\n  // const campaignData = useSelector((state) => state.campaignState.campaignDetails)\n  //   useEffect(() => {\n  //     if (campaignId) {\n  //         dispatch(getCampaignDetails(campaign, 0))\n  //     }\n  // }, [campaignId, dispatch])\n\n  const [data, setData] = useState([]);\n  const [numberOfPies, SetnumberOfPies] = useState([1]);\n  let history = useHistory();\n  useEffect(() => {\n    // NOTE: Fetch Campaign Details from Api\n    const fetchData = async num => {\n      let ApiUrlForSearch = '';\n      ApiUrlForSearch = api_url + '/' + campaignId + '?number=' + num;\n\n      if (locId !== null && locId !== 'null') {\n        ApiUrlForSearch = api_url + '/' + locId + '?number=' + num;\n      } else if (campaignId !== null && campaignId !== 'null') {\n        ApiUrlForSearch = api_url + '/' + campaignId + '?number=' + num;\n      } else {\n        //Note: Redirect on main page when campaignId Or Loalstorage Id is not found\n        history.push('/');\n      }\n\n      if (ApiUrlForSearch !== '') {\n        const result = await fetch(ApiUrlForSearch).then(response => {\n          return response.json();\n        }).catch(err => {\n          throw new Error(err);\n        });\n        setData(result);\n      }\n    };\n\n    let num = 0;\n    fetchData(num);\n    const interval = setInterval(() => {\n      num++;\n      fetchData(num);\n      numInc = num;\n    }, 5000);\n    return () => {\n      clearInterval(interval);\n    };\n  }, []);\n  useEffect(() => {\n    //Note: Store Data in Local storage\n    if (props.location.campaigns === undefined) {\n      if (locId !== null && locId !== 'null') {\n        window.localStorage.setItem(\"id\", locId);\n      }\n    } else {\n      window.localStorage.setItem(\"id\", props.location.campaigns.id);\n    } //Note: Handle page refresh scenario\n\n\n    if (props.location.campaigns === undefined) {\n      if (locName !== null && locName !== 'null') {\n        window.localStorage.setItem(\"name\", locName);\n      }\n    } else {\n      window.localStorage.setItem(\"name\", props.location.campaigns.name);\n    }\n  }, [locId, locName, props.location.campaigns]);\n\n  const calculateCtr = (impressions, clicks) => {\n    if (impressions && clicks) {\n      return clicks / impressions * 100;\n    } else {\n      return 0;\n    }\n  };\n\n  const totalCalculateCtr = () => {\n    if (calculateCtr(data.impressions, data.clicks) > 0) {\n      dataCtr.push(calculateCtr(data.impressions, data.clicks));\n    }\n\n    ;\n    var sum = dataCtr.reduce(function (prev, curr) {\n      return curr + prev;\n    }, 0);\n    return sum;\n  };\n\n  const totalImp = () => {\n    if (data.impressions) {\n      dataImp.push(data.impressions);\n    }\n\n    ;\n    var sum = dataImp.reduce(function (prev, curr) {\n      return curr + prev;\n    }, 0);\n    return sum;\n  };\n\n  const totalClicks = () => {\n    if (data.clicks) {\n      dataClicks.push(data.clicks);\n    }\n\n    ;\n    var sum = dataClicks.reduce(function (prev, curr) {\n      return curr + prev;\n    }, 0);\n    return sum;\n  };\n\n  const totalUsers = () => {\n    if (data.users) {\n      dataUsers.push(data.users);\n    }\n\n    ;\n    var sum = dataUsers.reduce(function (prev, curr) {\n      return curr + prev;\n    }, 0);\n    return sum;\n  };\n\n  const getChartData = () => {\n    let tempData = [];\n\n    if (data) {\n      tempData = [{\n        name: \"Total impressions\",\n        y: totalImp()\n      }, {\n        name: \"Total clicks\",\n        y: totalClicks()\n      }, {\n        name: \"Total users\",\n        y: totalUsers()\n      }, {\n        name: \"Total CTR\",\n        y: totalCalculateCtr()\n      }, {\n        name: \"Most impressions\",\n        y: data.impressions\n      }, {\n        name: \"Most clicks\",\n        y: data.clicks\n      }, {\n        name: \"Most users\",\n        y: data.users\n      }, {\n        name: \"CTR\",\n        y: calculateCtr(data.impressions, data.clicks)\n      }];\n    }\n\n    return tempData;\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Chart, {\n      data: getChartData(),\n      userConfig: template.userConfig,\n      titleName: campaignName\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-block\",\n      children: [/*#__PURE__*/_jsxDEV(Cardwrap, {\n        text: \"Total impressions\",\n        value: totalImp()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Cardwrap, {\n        text: \"Total click\",\n        value: totalClicks()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Cardwrap, {\n        text: \"Total CTR\",\n        value: totalCalculateCtr()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Cardwrap, {\n        text: \"Total users\",\n        value: totalUsers()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Cardwrap, {\n        text: \"Most recent impressions\",\n        value: data.impressions\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Cardwrap, {\n        text: \"Current Number\",\n        value: numInc\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Cardwrap, {\n        text: \"Most recent clicks\",\n        value: data.clicks\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Cardwrap, {\n        text: \"Most recent CTR\",\n        value: calculateCtr(data.impressions, data.clicks)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Cardwrap, {\n        text: \"Most recent users\",\n        value: data.users\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Dashboard, \"GZEmgQRHd9NJker9tKH2aAun4WY=\", false, function () {\n  return [useHistory];\n});\n\n_c = Dashboard;\nexport default Dashboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"sources":["D:/React_Projects/loblaw-ui-test/test/src/container/dashboard.js"],"names":["React","useState","useEffect","useDispatch","useSelector","getCampaignDetails","useHistory","Cardwrap","Chart","dataImp","dataClicks","dataUsers","dataCtr","numInc","locId","localStorage","getItem","locName","template","userConfig","tooltip","pointFormat","plotOptions","pie","showInLegend","innerSize","dataLabels","enabled","formatter","point","name","Math","round","y","format","distance","color","style","fontweight","fontsize","Dashboard","props","campaignId","location","campaigns","undefined","id","campaignName","api_url","data","setData","numberOfPies","SetnumberOfPies","history","fetchData","num","ApiUrlForSearch","push","result","fetch","then","response","json","catch","err","Error","interval","setInterval","clearInterval","window","setItem","calculateCtr","impressions","clicks","totalCalculateCtr","sum","reduce","prev","curr","totalImp","totalClicks","totalUsers","users","getChartData","tempData"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\n//Note: Include bootstrap for responsive layout\r\nimport 'bootstrap/dist/css/bootstrap.min.css';\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { getCampaignDetails } from \"../store/actions/campaign\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport Cardwrap from '../component/cardwrap';\r\nimport Chart from \"../component/Chart\"\r\nimport '../index.css'\r\n\r\nvar dataImp = [0]\r\nvar dataClicks = [0]\r\nvar dataUsers = [0]\r\nvar dataCtr = [0]\r\nvar numInc = 0\r\n//Note:Local storage variables\r\nconst locId = localStorage.getItem('id');\r\nconst locName = localStorage.getItem('name');\r\n\r\nconst template = {\r\n  userConfig: {\r\n    tooltip: {\r\n      pointFormat: \"<b>{point.y}</b>\"\r\n    },\r\n    plotOptions: {\r\n      pie: {\r\n        showInLegend: true,\r\n        innerSize: \"60%\",\r\n        dataLabels: {\r\n          enabled: true,\r\n          formatter() {\r\n            return this.point.name  + ' : ' + Math.round(this.point.y * 100);\r\n          },\r\n          format: '{point.name} : ' + Math.round(this.point.y * 100),\r\n          distance: 5,\r\n          color: \"black\",\r\n          style: {\r\n            fontweight: \"bold\",\r\n            fontsize: 50\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nconst Dashboard = (props) => {\r\n  const campaignId = props.location.campaigns === undefined ? locId : props.location.campaigns.id;\r\n  const campaignName = props.location.campaigns === undefined ? locName : props.location.campaigns.name;\r\n  let api_url = \"http://localhost:4000/campaigns\";\r\n\r\n  //Note: Using redux-store for state management\r\n  // const campaign = props.location.campaigns;\r\n  // const dispatch = useDispatch();\r\n  // const [campaignDetails, setCampaign] = useState();\r\n  // const campaignData = useSelector((state) => state.campaignState.campaignDetails)\r\n  //   useEffect(() => {\r\n  //     if (campaignId) {\r\n  //         dispatch(getCampaignDetails(campaign, 0))\r\n  //     }\r\n  // }, [campaignId, dispatch])\r\n\r\n  const [data, setData] = useState([])\r\n  const [numberOfPies, SetnumberOfPies] = useState([1])\r\n  let history = useHistory();\r\n  useEffect(() => {\r\n    // NOTE: Fetch Campaign Details from Api\r\n    const fetchData = async (num) => {\r\n      let ApiUrlForSearch = '';\r\n      ApiUrlForSearch = api_url + '/' + campaignId + '?number=' + num;\r\n      if (locId !== null && locId !== 'null') {\r\n        ApiUrlForSearch = api_url + '/' + locId + '?number=' + num;\r\n      }  else if (campaignId !== null && campaignId !== 'null') {\r\n        ApiUrlForSearch = api_url + '/' + campaignId + '?number=' + num;\r\n      } else {\r\n        //Note: Redirect on main page when campaignId Or Loalstorage Id is not found\r\n        history.push('/')\r\n      }\r\n      if(ApiUrlForSearch !== ''){\r\n        const result = await fetch(ApiUrlForSearch).then(response => {\r\n          return response.json()\r\n        }).catch(err => {\r\n          throw new Error(err)\r\n        })\r\n        setData(result);\r\n      }\r\n    }\r\n    let num = 0;\r\n    fetchData(num);\r\n    const interval = setInterval(() => {\r\n      num++;\r\n      fetchData(num)\r\n      numInc = num\r\n    }, 5000);\r\n    return () => { clearInterval(interval) }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    //Note: Store Data in Local storage\r\n    if(props.location.campaigns === undefined) {\r\n      if(locId !== null && locId !== 'null') {\r\n        window.localStorage.setItem(\"id\",locId)\r\n      }\r\n    } else {\r\n      window.localStorage.setItem(\"id\", props.location.campaigns.id)\r\n    }\r\n    //Note: Handle page refresh scenario\r\n    if(props.location.campaigns === undefined) {\r\n      if(locName !== null && locName !== 'null') {\r\n        window.localStorage.setItem(\"name\",locName)\r\n      }\r\n    } else {\r\n      window.localStorage.setItem(\"name\", props.location.campaigns.name)\r\n    }\r\n  }, [locId, locName, props.location.campaigns])\r\n\r\n  const calculateCtr = (impressions, clicks) => {\r\n    if (impressions && clicks) {\r\n      return (\r\n        (clicks / impressions) * 100\r\n      )\r\n    } else {\r\n      return 0;\r\n    }\r\n  }\r\n  const totalCalculateCtr = () => {\r\n    if (calculateCtr(data.impressions, data.clicks) > 0) {\r\n      dataCtr.push(calculateCtr(data.impressions, data.clicks))\r\n    };\r\n    var sum = dataCtr.reduce(function (prev, curr) {\r\n      return curr + prev;\r\n    }, 0);\r\n    return sum;\r\n  }\r\n  const totalImp = () => {\r\n    if (data.impressions) { dataImp.push(data.impressions) };\r\n    var sum = dataImp.reduce(function (prev, curr) {\r\n      return curr + prev;\r\n    }, 0);\r\n    return sum;\r\n  }\r\n  const totalClicks = () => {\r\n    if (data.clicks) { dataClicks.push(data.clicks) };\r\n    var sum = dataClicks.reduce(function (prev, curr) {\r\n      return curr + prev;\r\n    }, 0);\r\n    return sum;\r\n  }\r\n  const totalUsers = () => {\r\n    if (data.users) { dataUsers.push(data.users) };\r\n    var sum = dataUsers.reduce(function (prev, curr) {\r\n      return curr + prev;\r\n    }, 0);\r\n    return sum;\r\n  }\r\n  const getChartData = () => {\r\n    let tempData = [];\r\n    if (data) {\r\n       tempData = [\r\n        { name: \"Total impressions\", y: totalImp() },\r\n        { name: \"Total clicks\", y: totalClicks() },\r\n        { name: \"Total users\", y: totalUsers() },\r\n        { name: \"Total CTR\", y: totalCalculateCtr() },\r\n        { name: \"Most impressions\", y: data.impressions },\r\n        { name: \"Most clicks\", y: data.clicks },\r\n        { name: \"Most users\", y: data.users },\r\n        { name: \"CTR\", y: calculateCtr(data.impressions,data.clicks) },\r\n      ];\r\n    }\r\n    return tempData;\r\n  }\r\n  return (\r\n    <>\r\n    <Chart\r\n                  data={getChartData()}\r\n                  userConfig={template.userConfig}\r\n                  titleName={campaignName}\r\n                />\r\n    <div className=\"container-block\">\r\n      <Cardwrap text=\"Total impressions\" value={totalImp()} />\r\n      <Cardwrap text=\"Total click\" value={totalClicks()} />\r\n      <Cardwrap text=\"Total CTR\" value={totalCalculateCtr()} />\r\n      <Cardwrap text=\"Total users\" value={totalUsers()} />\r\n      <Cardwrap text=\"Most recent impressions\" value={data.impressions} />\r\n      <Cardwrap text=\"Current Number\" value={numInc} />\r\n      <Cardwrap text=\"Most recent clicks\" value={data.clicks} />\r\n      <Cardwrap text=\"Most recent CTR\" value={calculateCtr(data.impressions, data.clicks)} />\r\n      <Cardwrap text=\"Most recent users\" value={data.users} /> \r\n    </div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Dashboard;\r\n"]},"metadata":{},"sourceType":"module"}